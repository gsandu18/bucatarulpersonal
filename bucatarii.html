<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Recomandări de bucătari chefi – Bucătarul Personal</title>
<meta name="description" content="Recomandări curate de bucătari chefi: filtre rapide, rating, oraș și specializări. Profesioniști verificați, Premium.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f5f7f8; --card:#fff; --text:#0f1916; --muted:#5f6b72; --line:#e8ecef;
    --green:#0f6c51; --green-2:#0e5a43; --chip:#eef6f2; --gold:#f2c14e;
    --shadow:0 10px 35px rgba(16,24,40,.12); --radius:22px; --rsm:12px;
  }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text)}
  body{font:16px/1.6 "Inter",system-ui,sans-serif;padding-top:72px}

  /* Header fix */
  .site-header{position:fixed;inset:0 0 auto 0;height:72px;z-index:1000;
    background:rgba(0,0,0,.35);backdrop-filter:blur(8px);border-bottom:1px solid rgba(255,255,255,.08)}
  .site-header .container{max-width:1180px;margin:0 auto;height:72px;padding:0 18px;display:flex;align-items:center;justify-content:space-between}
  .logo img{height:36px}
  .nav{display:flex;gap:22px;align-items:center}
  .nav a{color:#fff;text-decoration:none;font-weight:600;font-size:15px}
  .nav .cta{background:#1a7f5a;padding:10px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.18);color:#fff}
  .hamburger{display:none}
  @media (max-width:980px){
    .hamburger{display:inline-flex;width:42px;height:42px;border-radius:10px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.15);align-items:center;justify-content:center;gap:5px}
    .hamburger span{width:18px;height:2px;background:#fff;border-radius:2px;display:block}
    .nav{position:fixed;top:72px;left:0;right:0;background:rgba(0,0,0,.85);backdrop-filter:blur(8px);display:none;flex-direction:column;padding:14px 16px;gap:12px}
    .nav.open{display:flex}
  }

  /* Hero */
  .hero{background:linear-gradient(180deg,#0c1d17,#0c1d1700),url('https://images.unsplash.com/photo-1495546968767-f0573cca821e?q=80&w=1800&auto=format&fit=crop') center/cover no-repeat;color:#fff}
  .hero .wrap{max-width:1180px;margin:0 auto;padding:56px 18px 34px}
  .hero h1{font-family:"Playfair Display",serif;font-weight:800;font-size:clamp(32px,4.2vw,52px);margin:0 0 8px}
  .hero p{margin:0;opacity:.95;font-size:18px}
  .wrap{max-width:1180px;margin:0 auto;padding:22px 18px 80px}

  /* FILTER BAR – desktop */
  .filter-bar{position:sticky;top:74px;z-index:900;background:var(--card);border:1px solid var(--line);
    box-shadow:0 12px 28px rgba(16,24,40,.10);border-radius:18px;margin-top:-18px;padding:12px}
  .fb-row{display:grid;grid-template-columns:1fr auto auto auto;gap:10px;align-items:center}
  .tabs{display:flex;gap:8px;flex-wrap:wrap}
  .tab{padding:10px 12px;border-radius:999px;border:1px solid #dfe7ea;background:#f6faf8;color:#113c31;font-weight:800;cursor:pointer}
  .tab.active{background:#dff1e9;border-color:#bfe2d2}
  .select, .sort{position:relative}
  select{appearance:none;background:#f8fafb;border:1px solid var(--line);border-radius:12px;padding:10px 36px 10px 12px;font-weight:700;cursor:pointer}
  .select:after, .sort:after{content:"";position:absolute;right:12px;top:50%;width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:7px solid #7d8b91;transform:translateY(-35%)}
  .search{position:relative}
  .search input{width:100%;height:42px;border-radius:12px;border:1px solid var(--line);background:#f8fafb;padding:10px 12px 10px 38px;font-weight:600}
  .search svg{position:absolute;left:12px;top:50%;transform:translateY(-50%);opacity:.6}
  .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
  .chip{background:var(--chip);border:1px solid #d7ebe2;color:#113c31;padding:8px 12px;border-radius:999px;font-weight:800;cursor:pointer}
  .chip.active{background:#dff1e9;border-color:#bfe2d2}
  .quick{display:flex;gap:10px;align-items:center;margin-top:8px;flex-wrap:wrap}
  .link{background:#fff;border:1px solid #cfe1da;border-radius:10px;padding:8px 10px;font-weight:800;color:#0f6c51;cursor:pointer}
  .reset{margin-left:auto}

  /* GRID & CARD */
  .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:24px;margin-top:24px}
  .col-4{grid-column:span 4}
  @media (max-width:1024px){.col-4{grid-column:span 6}}
  @media (max-width:680px){.col-4{grid-column:span 12}}

  .card{background:#fff;border-radius:22px;box-shadow:var(--shadow);display:grid;grid-template-rows:auto 1fr auto;min-height:520px;overflow:hidden;border:1px solid #eef2f4}
  .card:hover{transform:translateY(-3px);box-shadow:0 16px 42px rgba(16,24,40,.16)}
  .media{position:relative;padding-top:72%;background:#e6f2ec}
  .media img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;border-top-left-radius:22px;border-top-right-radius:22px}
  .media .label{position:absolute;left:12px;top:12px;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:800;background:rgba(0,0,0,.55);color:#fff;border:1px solid rgba(255,255,255,.18)}
  .media.is-broken{display:flex;align-items:center;justify-content:center;color:#1d3b2f;font-weight:700}
  .body{padding:18px 18px 10px}
  .name{font-size:22px;margin:2px 0 6px;font-weight:800;color:#112822}
  .sub{color:#5f6b72;font-size:15px;margin:0 0 10px}
  .rating{display:flex;align-items:center;gap:10px;margin-bottom:10px}
  .star{width:18px;height:18px}
  .percent{font-weight:800;color:#1a2f29}
  .chips-inline{display:flex;flex-wrap:wrap;gap:8px;margin:10px 0 14px}
  .chip-mini{background:var(--chip);border:1px solid #d7ebe2;padding:6px 10px;border-radius:999px;font-size:13px;font-weight:600}
  .foot{display:flex;align-items:center;justify-content:space-between;padding:14px 18px 18px}
  .badge{background:#f4ead2;color:#7a5a0b;border:1px solid #ead7aa;padding:7px 10px;border-radius:999px;font-weight:800;font-size:13px}
  .ev{background:#e8f5ee;border:1px solid #cfe9db;color:#124f3b;padding:7px 10px;border-radius:999px;font-weight:700;font-size:13px}

  .pagination{display:flex;gap:8px;justify-content:center;margin-top:26px}
  .page-btn{padding:10px 14px;border-radius:12px;border:1px solid var(--line);background:#fff;cursor:pointer;font-weight:700}
  .page-btn.active{background:var(--green);color:#fff;border-color:var(--green)}

  /* —— MOBILE FILTER MODAL —— */
  @media (max-width: 768px){ .filter-bar{ display:none !important; } }
  .fab-filters{
    position: sticky; bottom: calc(12px + env(safe-area-inset-bottom));
    left: 12px; z-index: 901; display:none; align-items:center; gap:8px;
    padding: 10px 14px; border-radius:999px; border:1px solid #cfe1da;
    background:#0f6c51; color:#fff; font-weight:800; box-shadow:0 8px 22px rgba(16,24,40,.18)
  }
  @media (max-width: 768px){ .fab-filters{ display:inline-flex; } }
  .filters-modal[hidden]{ display:none; }
  .filters-modal{
    position: fixed; inset: 0; z-index: 1000;
    background: rgba(0,0,0,.42); backdrop-filter: blur(4px);
    display: grid; place-items: end center;
    padding: 0 env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
  }
  .fm-sheet{ width:100%; max-width:640px; background:#fff; border-top-left-radius:16px; border-top-right-radius:16px;
    box-shadow:0 -16px 40px rgba(16,24,40,.24); max-height:92dvh; display:grid; grid-template-rows:auto 1fr auto }
  .fm-header{ display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border-bottom:1px solid #e8ecef }
  .fm-close{ background:#fff; border:1px solid #e8ecef; border-radius:10px; padding:6px 10px; font-weight:800; cursor:pointer }
  .fm-body{ padding:14px 16px; overflow:auto }
  .fm-lbl{ display:block; font-size:13px; font-weight:800; color:#27443a; margin:10px 0 6px }
  .fm-search{ position:relative }
  .fm-search input{ width:100%; height:44px; border:1px solid #e8ecef; border-radius:12px; padding:10px 12px 10px 38px; background:#f8fafb; font-weight:600 }
  .fm-search svg{ position:absolute; left:12px; top:50%; transform:translateY(-50%); opacity:.7 }
  .fm-row{ display:grid; grid-template-columns:1fr 1fr; gap:10px }
  .fm-col select{ width:100%; height:44px; border:1px solid #e8ecef; border-radius:12px; background:#f8fafb; font-weight:700; padding:10px 12px }
  .fm-tabs{ display:flex; gap:8px; flex-wrap:wrap }
  .fm-tabs button{ padding:10px 12px; border-radius:999px; border:1px solid #dfe7ea; background:#f6faf8; font-weight:800; color:#113c31 }
  .fm-tabs button.active{ background:#dff1e9; border-color:#bfe2d2 }
  .fm-chips{ display:flex; gap:8px; flex-wrap:wrap }
  .fm-chips button{ padding:8px 12px; border-radius:999px; border:1px solid #d7ebe2; background:#eef6f2; font-weight:800; color:#113c31 }
  .fm-chips button.active{ background:#dff1e9; border-color:#bfe2d2 }
  .fm-footer{ display:flex; gap:10px; justify-content:flex-end; padding:12px 16px; border-top:1px solid #e8ecef }
  .fm-btn{ padding:10px 14px; border-radius:12px; border:1px solid #cfe1da; font-weight:800; cursor:pointer }
  .fm-btn.primary{ background:#0f6c51; color:#fff; border-color:#0f6c51 }
  .fm-btn.ghost{ background:#fff }
</style>
</head>
<body>
  <!-- HEADER -->
  <header class="site-header">
    <div class="container">
      <a class="logo" href="/"><img src="/static/logo-bucatarul-personal.svg" alt="Bucătarul Personal"></a>
      <nav class="nav">
        <a href="/">Acasă</a><a href="/bucatari">Bucătarii noștri</a><a href="/servicii">Servicii</a><a href="/contul-meu">Contul meu</a>
        <a class="cta" href="/vreau-un-bucatar">Vreau un Bucătar</a>
      </nav>
      <button class="hamburger" aria-label="Meniu"><span></span><span></span><span></span></button>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero">
    <div class="wrap">
      <h1>Recomandări de bucătari chefi</h1>
      <p>Alege din selecția noastră după oraș, rating și specializare.</p>
    </div>
  </section>

  <!-- FILTER BAR (desktop) -->
  <section class="wrap">
    <div class="filter-bar" id="fb">
      <div class="fb-row">
        <div class="search">
          <input id="q" type="search" placeholder="Caută nume, oraș, specializare…">
          <!-- icon inline -->
          <svg width="18" height="18" viewBox="0 0 24 24" style="position:absolute;left:12px;top:50%;transform:translateY(-50%);opacity:.6">
            <path d="M21 21l-4.35-4.35M11 19a8 8 0 1 1 0-16 8 8 0 0 1 0 16z" fill="none" stroke="#122c23" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="tabs" role="tablist" aria-label="Preseturi">
          <button class="tab active" data-preset="all">Toți</button>
          <button class="tab" data-preset="premium">Premium</button>
          <button class="tab" data-preset="high">4.5★+</button>
        </div>
        <div class="select">
          <select id="city" aria-label="Oraș">
            <option value="">Oraș: Toate</option>
            <option>București</option><option>Cluj</option><option>Timișoara</option><option>Iași</option><option>Brașov</option>
          </select>
        </div>
        <div class="sort">
          <select id="sort" aria-label="Sortare">
            <option value="score">Sort: Relevanță</option>
            <option value="rating">Rating</option>
            <option value="events">Evenimente</option>
            <option value="name">Nume A–Z</option>
          </select>
        </div>
      </div>

      <div class="chips" id="catChips" aria-label="Categorii">
        <span class="chip" data-cat="Italian">Italian</span>
        <span class="chip" data-cat="BBQ">BBQ</span>
        <span class="chip" data-cat="Fine Dining">Fine Dining</span>
        <span class="chip" data-cat="Dietetic">Dietetic</span>
        <span class="chip" data-cat="Seafood">Seafood</span>
      </div>

      <div class="quick">
        <button class="link" id="onlyCity">Doar din orașul ales</button>
        <button class="link" id="topEvents">Top evenimente</button>
        <button class="link reset" id="reset">Reset</button>
      </div>
    </div>

    <!-- FAB (mobil) -->
    <button id="filtersFab" aria-haspopup="dialog" aria-controls="filtersModal" class="fab-filters">
      <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M21 21l-4.35-4.35M11 19a8 8 0 1 1 0-16 8 8 0 0 1 0 16z"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
      Filtre
    </button>

    <!-- MODAL (mobil) -->
    <div id="filtersModal" class="filters-modal" role="dialog" aria-modal="true" aria-labelledby="filtersTitle" hidden>
      <div class="fm-sheet" role="document">
        <div class="fm-header">
          <h3 id="filtersTitle">Filtre</h3>
          <button class="fm-close" id="filtersClose" aria-label="Închide">✕</button>
        </div>
        <div class="fm-body">
          <label class="fm-lbl">Căutare</label>
          <div class="fm-search">
            <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M21 21l-4.35-4.35M11 19a8 8 0 1 1 0-16 8 8 0 0 1 0 16z"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <input id="q-m" type="search" placeholder="Caută nume, oraș, specializare…">
          </div>

          <label class="fm-lbl">Preset</label>
          <div class="fm-tabs" id="tabs-m">
            <button data-preset="all" class="active">Toți</button>
            <button data-preset="premium">Premium</button>
            <button data-preset="high">4.5★+</button>
          </div>

          <div class="fm-row">
            <div class="fm-col">
              <label class="fm-lbl">Oraș</label>
              <select id="city-m">
                <option value="">Toate</option>
                <option>București</option><option>Cluj</option><option>Timișoara</option>
                <option>Iași</option><option>Brașov</option>
              </select>
            </div>
            <div class="fm-col">
              <label class="fm-lbl">Sortare</label>
              <select id="sort-m">
                <option value="score">Relevanță</option>
                <option value="rating">Rating</option>
                <option value="events">Evenimente</option>
                <option value="name">Nume A–Z</option>
              </select>
            </div>
          </div>

          <label class="fm-lbl">Categorii</label>
          <div class="fm-chips" id="chips-m">
            <button data-cat="Italian">Italian</button>
            <button data-cat="BBQ">BBQ</button>
            <button data-cat="Fine Dining">Fine Dining</button>
            <button data-cat="Dietetic">Dietetic</button>
            <button data-cat="Seafood">Seafood</button>
          </div>
        </div>
        <div class="fm-footer">
          <button id="reset-m" class="fm-btn ghost">Reset</button>
          <button id="apply-m" class="fm-btn primary">Aplică</button>
        </div>
      </div>
    </div>

    <!-- GRID -->
    <div class="grid" id="results" aria-live="polite"></div>
    <div class="pagination" id="pagination"></div>
  </section>

<script>
  // Mobile menu
  const btn = document.querySelector('.hamburger'); const nav = document.querySelector('.nav');
  if (btn) btn.addEventListener('click',()=>nav.classList.toggle('open'));

  // Data (6 chefi)
  const CHEFS = [
    {id:'matei',name:'Chef Matei',city:'București',tags:['Fine Dining','Seafood'],event:['private','corporate'],rating:4.8,ratingPct:97,events:160,premium:true,photo:'https://images.unsplash.com/photo-1522335789203-aabd1fc54bc9?q=80&w=1600&auto=format&fit=crop',subtitle:'Fine Dining • București'},
    {id:'elisa',name:'Chef Elisa',city:'Cluj',tags:['Italian','Seafood'],event:['private','corporate'],rating:4.6,ratingPct:96,events:98,premium:true,photo:'https://images.unsplash.com/photo-1514511548324-9163e91b0b48?q=80&w=1600&auto=format&fit=crop',subtitle:'Italian • Cluj'},
    {id:'radu',name:'Chef Radu',city:'Timișoara',tags:['BBQ','Corporate'],event:['corporate','private'],rating:4.5,ratingPct:94,events:110,premium:true,photo:'https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?q=80&w=1600&auto=format&fit=crop',subtitle:'BBQ & Events • Timișoara'},
    {id:'ioana',name:'Chef Ioana',city:'București',tags:['Dietetic','Family style'],event:['family','private'],rating:5,ratingPct:100,events:140,premium:true,photo:'',subtitle:'Healthy & Family • București'},
    {id:'andreea',name:'Chef Andreea',city:'Iași',tags:['Italian','Family style'],event:['family','private'],rating:4.7,ratingPct:95,events:86,premium:false,photo:'https://images.unsplash.com/photo-1517411032315-54ef2cb783bb?q=80&w=1600&auto=format&fit=crop',subtitle:'Italian • Iași'},
    {id:'bogdan',name:'Chef Bogdan',city:'Brașov',tags:['BBQ','Seafood'],event:['corporate','private'],rating:4.4,ratingPct:92,events:74,premium:false,photo:'https://images.unsplash.com/photo-1562059390-a761a084768e?q=80&w=1600&auto=format&fit=crop',subtitle:'BBQ • Brașov'}
  ];

  // Elements
  const resultsEl = document.getElementById('results');
  const pagEl = document.getElementById('pagination');
  const qEl = document.getElementById('q');
  const cityEl = document.getElementById('city');
  const sortEl = document.getElementById('sort');
  const chips = document.querySelectorAll('#catChips .chip');
  const tabs = document.querySelectorAll('.tab');
  document.getElementById('reset').addEventListener('click',()=>{ qEl.value=''; cityEl.value=''; sortEl.value='score'; chips.forEach(c=>c.classList.remove('active')); preset='all'; tabs.forEach(t=>t.classList.remove('active')); tabs[0].classList.add('active'); apply(); });
  document.getElementById('onlyCity').addEventListener('click',()=>{ if(!cityEl.value) return; preset='all'; apply(); });
  document.getElementById('topEvents').addEventListener('click',()=>{ sortEl.value='events'; apply(); });

  // Tab presets
  let preset = 'all';
  tabs.forEach(t=>t.addEventListener('click',()=>{
    tabs.forEach(x=>x.classList.remove('active')); t.classList.add('active'); preset = t.dataset.preset; apply();
  }));

  // Chips select
  let selectedCats = new Set();
  chips.forEach(ch=>ch.addEventListener('click',()=>{
    const v = ch.dataset.cat;
    if(selectedCats.has(v)){ selectedCats.delete(v); ch.classList.remove('active'); }
    else { selectedCats.add(v); ch.classList.add('active'); }
    apply();
  }));

  [qEl, cityEl, sortEl].forEach(el=>el.addEventListener('input', apply));

  // Render helpers
  const PAGE = 9; let filtered = CHEFS.slice();
  function renderStars(r){
    const full = Math.floor(r), half = r-full>=0.5?1:0;
    let out=''; for(let i=0;i<full;i++) out+=`<svg class="star" viewBox="0 0 24 24" fill="var(--gold)"><path d="M12 2l3.09 6.26L22 9.27l-5 4.88L18.18 22 12 18.56 5.82 22 7 14.15l-5-4.88 6.91-1.01L12 2z"/></svg>`;
    if(half) out+=`<svg class="star" viewBox="0 0 24 24"><defs><linearGradient id="half"><stop offset="50%" stop-color="var(--gold)"/><stop offset="50%" stop-color="#e1e6ea"/></linearGradient></defs><path d="M12 2l3.09 6.26L22 9.27l-5 4.88L18.18 22 12 18.56 5.82 22 7 14.15l-5-4.88 6.91-1.01L12 2z" fill="url(#half)"/></svg>`;
    return out;
  }
  function card(c){
    const img = c.photo ? `<img loading="lazy" src="${c.photo}" alt="${c.name}">` : '';
    const broken = c.photo ? '' : ' is-broken';
    const label = c.premium ? `<span class="label">Premium</span>` : '';
    const chips = c.tags.map(t=>`<span class="chip-mini">${t}</span>`).join('');
    return `<article class="card col-4">
      <div class="media${broken}">
        ${label}${img || 'Imagine indisponibilă'}
      </div>
      <div class="body">
        <h3 class="name">${c.name}</h3>
        <p class="sub">${c.subtitle}</p>
        <div class="rating"><div class="stars" aria-label="${c.rating} din 5">${renderStars(c.rating)}</div><span class="percent">${c.ratingPct}%</span></div>
        <div class="chips-inline">${chips}</div>
      </div>
      <div class="foot"><span class="badge">Premium</span><span class="ev">${c.events} evenimente</span></div>
    </article>`;
  }
  function render(){
    resultsEl.innerHTML = filtered.slice(0,PAGE).map(card).join('');
    pagEl.innerHTML = ''; // 6 iteme => o singură pagină în demo
    // broken fallback (pentru imaginile lipsă)
    document.querySelectorAll('.media img').forEach(img=>{
      img.addEventListener('error',()=>{ const p=img.closest('.media'); p.classList.add('is-broken'); p.innerHTML='Imagine indisponibilă'; }, {once:true});
    });
  }

  function apply(){
    const q = qEl.value.trim().toLowerCase();
    const city = cityEl.value;
    filtered = CHEFS.filter(c=>{
      const okQ = !q || [c.name,c.city,c.tags.join(' '),c.subtitle].join(' ').toLowerCase().includes(q);
      const okCity = !city || c.city===city;
      const okCat = selectedCats.size===0 || [...selectedCats].every(t=>c.tags.includes(t));
      let okPreset = true;
      if(preset==='premium') okPreset = !!c.premium;
      if(preset==='high') okPreset = c.rating>=4.5;
      return okQ && okCity && okCat && okPreset;
    });
    // sort
    const by = sortEl.value;
    filtered.sort((a,b)=>{
      if(by==='rating') return b.rating-a.rating;
      if(by==='events') return b.events-a.events;
      if(by==='name') return a.name.localeCompare(b.name);
      const sA=a.rating*0.7 + a.events*0.03 + (a.premium?0.4:0);
      const sB=b.rating*0.7 + b.events*0.03 + (b.premium?0.4:0);
      return sB-sA;
    });
    render();
  }

  // init
  apply();

  /* ========= MOBILE FILTER MODAL LOGIC ========= */
  (function(){
    const fab = document.getElementById('filtersFab');
    const modal = document.getElementById('filtersModal');
    const closeBtn = document.getElementById('filtersClose');

    const main = {
      q: document.getElementById('q'),
      city: document.getElementById('city'),
      sort: document.getElementById('sort'),
      chipsWrap: document.getElementById('catChips'),
      get selectedCats(){ return Array.from(this.chipsWrap.querySelectorAll('.chip.active')).map(c=>c.dataset.cat); },
      setCats(arr){ this.chipsWrap.querySelectorAll('.chip').forEach(c=> c.classList.toggle('active', arr.includes(c.dataset.cat))); }
    };

    const m = {
      q: document.getElementById('q-m'),
      city: document.getElementById('city-m'),
      sort: document.getElementById('sort-m'),
      tabs: document.querySelectorAll('#tabs-m button'),
      chipsWrap: document.getElementById('chips-m'),
      getCats(){ return Array.from(this.chipsWrap.querySelectorAll('button.active')).map(b=>b.dataset.cat); },
      setCats(arr){ this.chipsWrap.querySelectorAll('button').forEach(b=> b.classList.toggle('active', arr.includes(b.dataset.cat))); },
      getPreset(){ const a=[...this.tabs].find(b=>b.classList.contains('active')); return a?a.dataset.preset:'all'; },
      setPreset(p){ this.tabs.forEach(b=> b.classList.toggle('active', b.dataset.preset===p)); }
    };

    function syncToModal(){
      m.q.value = main.q.value || '';
      m.city.value = main.city.value || '';
      m.sort.value = main.sort.value || 'score';
      m.setCats(main.selectedCats);
      // deducem presetul simplu
      if (preset==='premium' || preset==='high') m.setPreset(preset); else m.setPreset('all');
    }
    function applyFromModal(){
      main.q.value = m.q.value || '';
      main.city.value = m.city.value || '';
      main.sort.value = m.sort.value || 'score';
      main.setCats(m.getCats());
      const p = m.getPreset();
      preset = p;
      apply();
    }

    function openModal(){ syncToModal(); modal.hidden = false; document.documentElement.style.overflow='hidden'; }
    function closeModal(){ modal.hidden = true; document.documentElement.style.overflow=''; }

    fab?.addEventListener('click', openModal);
    closeBtn?.addEventListener('click', closeModal);
    modal?.addEventListener('click', (e)=>{ if(e.target===modal) closeModal(); });
    window.addEventListener('keydown', (e)=>{ if(!modal.hidden && e.key==='Escape') closeModal(); });

    m.chipsWrap?.addEventListener('click', (e)=>{ const b=e.target.closest('button[data-cat]'); if(!b) return; b.classList.toggle('active'); });
    m.tabs.forEach(b=> b.addEventListener('click', ()=>{ m.tabs.forEach(x=>x.classList.remove('active')); b.classList.add('active'); }));
    document.getElementById('reset-m')?.addEventListener('click', ()=>{ m.q.value=''; m.city.value=''; m.sort.value='score'; m.setCats([]); m.setPreset('all'); });
    document.getElementById('apply-m')?.addEventListener('click', ()=>{ applyFromModal(); closeModal(); });
  })();
</script>
</body>
</html>
